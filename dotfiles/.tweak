
#######################################
# Clean up the Linux system based on OS
# - Keeps function name 'cleanup' for compatibility
#######################################
cleanup() {
  info "🧹 Starting system cleanup on $(hostname)"

  if command -v apt-get >/dev/null 2>&1; then
    sudo apt-get update -y
    # prefer dist-upgrade, fallback to upgrade
    sudo apt-get dist-upgrade -y || sudo apt-get upgrade -y
    sudo apt-get autoremove -y
    sudo apt-get autoclean -y
    sudo apt-get clean -y
    warning "APT cleanup done."
  elif command -v pacman >/dev/null 2>&1; then
    sudo pacman -Syu --noconfirm
    # remove orphans if any
    orphans="$(pacman -Qtdq 2>/dev/null || true)"
    if [ -n "$orphans" ]; then
      sudo pacman -Rns --noconfirm $orphans || true
      info "Removed pacman orphans."
    fi
    # clean cache (keep 1 version); fallback to Sc if paccache missing
    if command -v paccache >/dev/null 2>&1; then
      sudo paccache -rk1 || true
    else
      sudo pacman -Sc --noconfirm || true
    fi
    warning "Pacman cleanup done."
  else
    error "Unsupported package manager – nothing to clean."
    return 1
  fi

  info "✅ Cleanup finished."
}

##########################################
# Clean up the thumbnails from the cache
# - Keeps function name 'cleanupThumbnails'
##########################################
cleanupThumbnails() {
    local cache_path="$HOME/.cache/thumbnails"
    if [[ -d "$cache_path" ]]; then
        info "🗑️ Cleaning thumbnail cache in $cache_path..."
        rm -rf "${cache_path:?}/"*
    else
        warning "Thumbnail cache directory not found: $cache_path"
    fi
}

#######################################
# Internal: Debian-based cleanup
#######################################
cleanup_debian_based() {
    info "[Debian/Ubuntu] Running apt cleanup..."
    sudo apt-get autoclean -y
    sudo apt-get clean
    sudo apt-get autoremove -y
    sudo apt --fix-broken install -y
    sudo apt-get update -y
    sudo apt-get upgrade -y
}

#######################################
# Internal: Arch-based cleanup
#######################################
cleanup_arch_based() {
    info "[Manjaro/Arch] Running pacman/pamac cleanup..."
    pamac clean --build-files --no-confirm || true
    sudo pacman -Rns $(pacman -Qtdq) --noconfirm 2>/dev/null || info "No orphaned packages to remove"
    sudo pacman -Syu --noconfirm
}